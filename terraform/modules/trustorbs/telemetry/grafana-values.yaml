# Grafana Helm Chart Values

# Admin credentials
admin:
  existingSecret: ""
  userKey: admin-user
  passwordKey: admin-password

env:
  GF_SECURITY_ADMIN_USER: ${grafana_admin_username}
  GF_SECURITY_ADMIN_PASSWORD: ${grafana_admin_password}
  GF_SERVER_PROTOCOL: https
  GF_SERVER_CERT_FILE: /etc/grafana-tls/tls.crt
  GF_SERVER_CERT_KEY: /etc/grafana-tls/tls.key
  GF_SERVER_DOMAIN: ${grafana_domain}
  GF_SERVER_ROOT_URL: https://${grafana_domain}

# Persistent storage for dashboards and configuration
persistence:
  enabled: true
  type: pvc
  size: 10Gi
  storageClassName: default

# Prometheus datasource configuration
datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
      - name: Prometheus
        type: prometheus
        url: http://prometheus-server.monitoring.svc.cluster.local
        access: proxy
        isDefault: true
        jsonData:
          timeInterval: 30s

# Dashboard provisioning configuration
dashboardProviders:
  dashboardproviders.yaml:
    apiVersion: 1
    providers:
      - name: 'default'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        editable: true
        options:
          path: /var/lib/grafana/dashboards/default

# Dashboard ConfigMap mounting
dashboardsConfigMaps:
  default: "grafana-dashboards"

# Resource limits and requests
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi

# Service configuration (ClusterIP - LoadBalancer created separately)
service:
  type: ClusterIP
  port: 3000

# Liveness and readiness probes configuration for HTTPS
livenessProbe:
  httpGet:
    path: /api/health
    port: 3000
    scheme: HTTPS
  initialDelaySeconds: 60
  timeoutSeconds: 30
  failureThreshold: 10

readinessProbe:
  httpGet:
    path: /api/health
    port: 3000
    scheme: HTTPS
  initialDelaySeconds: 30
  timeoutSeconds: 30

# Mount TLS certificate secret
extraSecretMounts:
  - name: grafana-tls
    secretName: grafana-tls-secret
    defaultMode: 0440
    mountPath: /etc/grafana-tls
    readOnly: true

# Disable anonymous access
auth:
  anonymous:
    enabled: false

# Disable telemetry
analytics:
  reporting_enabled: false
  check_for_updates: false
